/* Inspector.js v0.1.0 */
!function(a){"use strict";function b(){return this._method=arguments[0],this._url=arguments[1],console.log(s.prototype.open),s.prototype.open.apply(this,arguments)}function c(){return this._request_headers=this._request_headers||{},this._request_headers[arguments[0]]=arguments[1],s.prototype.setRequestHeader.apply(this,arguments)}function d(){return this._mime_type=arguments[0],s.prototype.overrideMimeType.apply(this,arguments)}function e(){return{navigator:{appCodeName:navigator.appCodeName,appName:navigator.appName,onLine:navigator.onLine,platform:navigator.platform,product:navigator.product,productSub:navigator.productSub,vendor:navigator.vendor,vendorSub:navigator.vendorSub}}}function f(){for(var a=navigator.userAgent.toLowerCase().replace(/ /g,"").split(""),b=0,c=0;c<a.length;c++)b+=a[c].charCodeAt();return b}function g(b,c){var d;if("FormData"in a){d=new FormData;for(var e in c)d.append(e,c[e])}else{b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d=[];for(var f in c)d.push(f+"="+encodeURIComponent(c[f]));d=d.join("&")}return d}function h(b,c){a.setTimeout(function(){H.get({url:r+"/instructions?last_id="+C+"&device_id="+D,data:b,onload:function(d){if(d=JSON.parse(d),d&&d.id){C=d.id;try{var e=new Function("try {"+d.code+"}catch(e){ Logg.error({message: e.message, stack: e.stack}); }");e.call(a)}catch(f){I.error({name:f.name,message:f.message,stack:f.stack}),G&&alert("Name: "+f.name+"\nMessage: "+f.message+"\nStack:"+f.stack)}}h(b,c)}})},c)}function i(a){var b=Date.now(),c=Math.random()*b,d=Math.ceil(b+c);a.setAttribute("data-loggid",d);for(var e=0;e<a.children.length;e++)i(a.children[e])}function j(a){var b=a.tagName.toLowerCase();return""!==a.id&&(b+="#"+a.id),""!==a.className&&(b+="#"+a.className.replace(/ /g,".")),b}function k(a){var b,c;b=[];for(var c in a)b.push(c);return b}function l(a,b){var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.matchesSelector||a.matches;return void 0===c?!1:c.call(a,b)}function m(a){for(var b={},c=[].slice.call(a,0),d=0;d<c.length;d++)b[c[d]]=a.getPropertyValue(c[d]);return b}function n(b){var c;if("string"==typeof b||"number"==typeof b||"boolean"==typeof b)c=b;else if(b instanceof String||b instanceof Number||b instanceof Boolean)c=b.constructor(b);else if("undefined"==typeof b)c="undefined";else if(null===b)c=null;else if(b instanceof Function)c=b.toString();else if(b instanceof Date)c=b;else if(b instanceof Document)c="#document";else if(a.Window&&b instanceof a.Window)c="window";else if(a.DOMWindow&&b instanceof a.DOMWindow)c="window";else if(b instanceof Comment)c="<!--"+b.nodeValue+"-->";else if(b instanceof Text)c=b.nodeValue;else if(b instanceof Attr)c={},c[b.name]=b.nodeValue;else if(b instanceof HTMLElement){c={};for(var d=k(b),e=0;e<d.length;e++){var f=d[e];try{h=b[f]}catch(g){h=void 0}h instanceof HTMLElement&&(h=j(h)),c[f]=n(h)}}else if(b instanceof Array||b instanceof NodeList||b instanceof HTMLCollection){c=[];for(var e=0;e<b.length;e++){var h=b[e];h instanceof HTMLElement&&(h=j(h)),c.push(n(h))}}else if(b instanceof Object){c={};for(var d=k(b),e=0;e<d.length;e++){var f=d[e];c[f]=n(b[f])}}return c}function o(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];b(e)&&c.push(e)}return c}function p(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push(b(e))}return c}function q(a){var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return a.replace(b,"")}var r="http://loggio.herokuapp.com/endpoint",s=a.XMLHttpRequest,t=function(){this.xhr=new s;var a=this;a.readyState=a.xhr.readyState,a.response=a.xhr.response,a.responseText=a.xhr.responseText,a.responseXML=a.xhr.responseXML,a.responseType=a.xhr.responseType,a.status=a.xhr.status,a.statusText=a.xhr.statusText,a._request_headers={},a._id=Date.now();var b=0;a.xhr.addEventListener("readystatechange",function(){var c="",d={};try{a.readyState=a.xhr.readyState,a.response=a.xhr.response,a.responseText=a.xhr.responseText,a.responseXML=a.xhr.responseXML,a.responseType=a.xhr.responseType,a.status=a.xhr.status,a.statusText=a.xhr.statusText,c=a._url,d=a.xhr.getAllResponseHeaders()}catch(e){}var f={id:a._id+"_"+b,readyState:a.readyState,status:a.status,statusText:a.statusText,responseText:a.responseText,responseType:a.responseType,request_headers:a._request_headers,response_headers:d,method:a._method,mime_type:a._mime_type,url:c,at:Math.round((new Date).getTime()/1e3)};H.post({url:r+"/messages",data:{message_type:"xhr",internal_id:a._id,content:JSON.stringify(n(f))}}),b+=1})};t.prototype=Object.create(s.prototype),t.prototype.addEventListener=function(){return this.xhr.addEventListener.apply(this.xhr,arguments)},t.prototype.abort=function(){return this.xhr.abort.apply(this.xhr,arguments)},t.prototype.getAllResponseHeaders=function(){return this.xhr.getAllResponseHeaders.apply(this.xhr,arguments)},t.prototype.getResponseHeader=function(){return this.xhr.getResponseHeader.apply(this.xhr,arguments)},t.prototype.open=function(){return this._method=arguments[0],this._url=arguments[1],this.xhr.open.apply(this.xhr,arguments)},t.prototype.overrideMimeType=function(){return this._mime_type=arguments[0],this.xhr.overrideMimeType.apply(this.xhr,arguments)},t.prototype.send=function(){return this.xhr.send.apply(this.xhr,arguments)},t.prototype.setRequestHeader=function(){return this._request_headers=this._request_headers||{},this._request_headers[arguments[0]]=arguments[1],this.setRequestHeader.apply(this.xhr,arguments)},a.XMLHttpRequest=t,a.addEventListener("load",function(){function e(){var a=new s,e=0,f=Date.now();return a.open=b,a.setRequestHeader=c,a.overrideMimeType=d,a.addEventListener("readystatechange",function(){var a={id:f+"_"+e,readyState:this.readyState,status:this.status,statusText:this.statusText,responseText:this.responseText,responseType:this.responseType,request_headers:this._request_headers,response_headers:this.getAllResponseHeaders(),method:this._method,at:Math.round((new Date).getTime()/1e3),mime_type:this._mime_type,url:this._url};H.post({url:r+"/messages",data:{message_type:"xhr",internal_id:f,content:JSON.stringify(n(a))}}),e+=1}),a}"jQuery"in a&&(a.jQuery.support.cors=!0,a.jQuery.ajaxSettings.xhr=e),"Zepto"in a&&(a.Zepto.support.cors=!0,a.Zepto.ajaxSettings.xhr=e)});var u;u="EventTarget"in a?EventTarget.prototype:Node.prototype;var v=u.addEventListener,w=u.removeEventListener,x={},y=[];u.addEventListener=function(){var a=y.indexOf(this);-1===a&&(y.push(this),a=y.indexOf(this));var b=arguments[0];x[a]=x[a]||{},x[a][b]=x[a][b]||[],x[a][b].push({handler:arguments[1],useCapture:void 0===arguments[2]?!1:arguments[2]}),v.apply(this,arguments)},u.removeEventListener=function(){var a=y.indexOf(this);if(a>-1){x[a]=x[a]||{},x[a][arguments[0]]=x[a][arguments[0]]||[];for(var b=0;b<x[a][arguments[0]].length;b++){var c=x[a][arguments[0]][b];if(c.handler===arguments[1]){x[a][arguments[0]].splice(b,1);break}}}w.apply(this,arguments)};var z,A=!1,B=1500,C=0,D=0,E=0,F=!1,G=!1,H={request:function(b,c){try{c=c||{},c.data=c.data||{},c.data.device_id=D;var d=new s;if(d.open(b,c.url,!0),d.onerror=function(){4===this.readyState&&c.onload&&(d.responseText&&""!==d.responseText||(d.responseText={}),c.onload.call(a,d.responseText)),d=null},d.onload=function(){4===this.readyState&&c.onload&&c.onload.call(a,d.responseText),d=null},"POST"===b){var e=g(d,c.data);d.send(e)}else d.send()}catch(f){alert(JSON.stringify(f))}},get:function(a){H.request("GET",a)},post:function(a){H.request("POST",a)}},I={settings:{},register:function(b){this.settings.navigator=navigator.userAgent;var c=b.identifier;(b.alertOnError===!0||b.alertOnError===!1)&&(G=b.alertOnError),b.name?this.settings.name=b.name:(this.settings.name=c.replace(/-/g," "),this.settings.name=this.settings.name[0].toUpperCase()+this.settings.name.substring(1)),-1===this.settings.name.indexOf("("+navigator.platform+")")&&(this.settings.name=this.settings.name+" ("+navigator.platform+")"),this.settings.identifier=-1===c.indexOf("-"+f())?c+"-"+f():c,this.settings.group=b.group?b.group:c.replace("-"+f(),""),this.settings.client_key=b.client_key;var d={identifier:this.settings.identifier,navigator:this.settings.navigator,name:this.settings.name,client_key:this.settings.client_key,group:this.settings.group};H.post({url:r+"/register",data:d,onload:function(a){F=!0;var a=JSON.parse(a);a&&"error"in a?alert(a.error):(a.id&&(C=a.id),a&&(D=a.device_id),a.device_group_id&&(E=a.device_group_id),D&&(I.init(),I.trackLocation()))}}),i(document.documentElement),window.onload=I.initHighlight,"jQuery"in a&&t&&(a.jQuery.ajaxSettings.xhr=function(){try{return new t}catch(a){}})},init:function(){if(I.log&&I.log("DOMScope is working now"),F){A=void 0!==this.settings.polling?this.settings.polling:A,B=void 0!=this.settings.pollingInterval?this.settings.pollingInterval:B;var a={last_id:C,device_id:D};h(a,B)}},destroy:function(){z&&a.clearInterval(z)}};a.onerror=function(a,b,c,d){var e={message_type:"native_error",content:{message:a,script:b,line:c}};return void 0!==d&&(e.content.column=d),e.content=JSON.stringify(e.content),H.post({url:r+"/messages",data:e}),G&&alert("Message: "+a+"\nScript: "+b+":"+c),!0};var J=["log","info","warn","error"];for(var K in J){var L=J[K];!function(a){I[a]=function(){var b=[].slice.call(arguments,0),c={message_type:a,content:JSON.stringify(n(b))};H.post({url:r+"/messages",data:c})}}(L)}I.trace=function(b){try{var b=new Function("try { return "+b+"}catch(e){ Logg.error({message: e.message, stack: e.stack}); }");b.call(a).apply(a,[].slice.call(arguments,1))}catch(c){I.error({name:c.name,message:c.message,stack:c.stack})}},I.initHighlight=function(){var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div");b.id="margin_container",c.id="border_container",d.id="padding_container",e.id="content_container",b.style.position="absolute",c.style.position="absolute",d.style.position="absolute",e.style.position="absolute",b.style.backgroundColor="rgb(211, 84, 0)",c.style.backgroundColor="rgb(243, 156, 18)",d.style.backgroundColor="rgb(39, 174, 96)",e.style.backgroundColor="rgb(41, 128, 185)",b.style.opacity="0.35",d.appendChild(e),c.appendChild(d),b.appendChild(c),b.style.width="0px",b.style.height="0px",b.style.zIndex=9999,b.style.overflow="hidden",a.document.body.appendChild(b)},I.resetHighlight=function(){var b=a.document.getElementById("margin_container");b.style.width="0px",b.style.height="0px"},I.highlightElement=function(b){if("string"==typeof b&&"querySelector"in a.document&&(b=a.document.querySelector(b)),!b)return!1;if(!("getBoundingClientRect"in b||"getComputedStyle"in a))return!1;var c=a.getComputedStyle(b),d=b.getBoundingClientRect(),e={contentWidth:parseInt(b.clientWidth)-parseInt(c.paddingLeft)-parseInt(c.paddingRight)-parseInt(c.borderLeftWidth)-parseInt(c.borderRightWidth),contentHeight:parseInt(b.clientHeight)-parseInt(c.paddingTop)-parseInt(c.paddingBottom)-parseInt(c.borderTopWidth)-parseInt(c.borderBottomWidth),borderTopWidth:parseInt(c.borderTopWidth),borderBottomWidth:parseInt(c.borderBottomWidth),borderLeftWidth:parseInt(c.borderLeftWidth),borderRightWidth:parseInt(c.borderRightWidth),marginTop:parseInt(c.marginTop),marginBottom:parseInt(c.marginBottom),marginLeft:parseInt(c.marginLeft),marginRight:parseInt(c.marginRight),paddingTop:parseInt(c.paddingTop),paddingBottom:parseInt(c.paddingBottom),paddingLeft:parseInt(c.paddingLeft),paddingRight:parseInt(c.paddingRight),clientWidth:b.clientWidth,clientHeight:b.clientHeight},f=document.getElementById("margin_container"),g=document.getElementById("border_container"),h=document.getElementById("padding_container"),i=document.getElementById("content_container");f.style.top=d.top-e.marginTop+"px",f.style.left=d.left-e.marginLeft+"px",f.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+e.marginLeft+e.marginRight+"px",f.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+e.marginTop+e.marginBottom+"px",g.style.top=e.marginTop+"px",g.style.left=e.marginLeft+"px",g.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+e.borderLeftWidth+e.borderRightWidth+"px",g.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+e.borderTopWidth+e.borderBottomWidth+"px",h.style.top="0px",h.style.left="0px",h.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+"px",h.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+"px",i.style.top=e.paddingTop+"px",i.style.left=e.paddingLeft+"px",i.style.width=e.contentWidth+"px",i.style.height=e.contentHeight+"px"},I.getDOM=function(){var a=document.doctype,b="";if(a)var b="<!DOCTYPE "+a.name+(a.publicId?' PUBLIC "'+a.publicId+'"':"")+(!a.publicId&&a.systemId?" SYSTEM":"")+(a.systemId?' "'+a.systemId+'"':"")+">";var c={message_type:"dom",content:b+document.documentElement.outerHTML,in_reply_to:C};H.post({url:r+"/messages",data:c})},I.getMediaQueries=function(b){var c=o(document.styleSheets,function(a){return a.cssRules||a.rules}),d={},e=!!a.matchMedia;if(e)for(var f=0;f<c.length;f++){var g=c[f],h=g.href,i=g.cssRules||g.rules||[];"STYLE"===g.ownerNode.tagName&&(h="style_"+g.ownerNode.getAttribute("data-loggid"));var j=o(i,function(a){return a instanceof CSSMediaRule}),k=[];j=p(j,function(a){return a.media.mediaText});for(var l=0;l<j.length;l++){var m=j[l];-1===k.indexOf(m)&&a.matchMedia(m).matches&&k.push(m)}k.length>0&&(d[h]=k)}return void 0!==b&&b!==!0?d:void H.post({url:r+"/messages",data:{message_type:"media_queries",content:JSON.stringify(n(d)),in_reply_to:C}})},I.boxModel=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e=a.getComputedStyle(d),f={};f[b]={contentWidth:parseInt(d.clientWidth)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),contentHeight:parseInt(d.clientHeight)-parseInt(e.paddingTop)-parseInt(e.paddingBottom)-parseInt(e.borderTopWidth)-parseInt(e.borderBottomWidth),borderTopWidth:parseInt(e.borderTopWidth),borderBottomWidth:parseInt(e.borderBottomWidth),borderLeftWidth:parseInt(e.borderLeftWidth),borderRightWidth:parseInt(e.borderRightWidth),marginTop:parseInt(e.marginTop),marginBottom:parseInt(e.marginBottom),marginLeft:parseInt(e.marginLeft),marginRight:parseInt(e.marginRight),paddingTop:parseInt(e.paddingTop),paddingBottom:parseInt(e.paddingBottom),paddingLeft:parseInt(e.paddingLeft),paddingRight:parseInt(e.paddingRight),clientWidth:d.clientWidth,clientHeight:d.clientHeight,offsetWidth:d.offsetWidth,offsetHeight:d.offsetHeight,scrollWidth:d.scrollWidth,scrollHeight:d.scrollHeight};var g={message_type:"box_model",content:JSON.stringify(f),in_reply_to:C};return void 0!==c&&c!==!0?g:void H.post({url:r+"/messages",data:g})},I.getComputedStyle=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e={},f=a.getComputedStyle(d),g=Array.prototype.slice.call(f,0);e[b]=m(f),d=f=g=null;var h={message_type:"computed_style",content:JSON.stringify(e),in_reply_to:C};return void 0!==c&&c!==!0?h:void H.post({url:r+"/messages",data:h})},I.getElementProperties=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e={message_type:"element_properties",content:JSON.stringify(n(d)),in_reply_to:C};return void 0!==c&&c!==!0?e:void H.post({url:r+"/messages",data:e})},I.getElementStyles=function(b,c){if(!("querySelector"in a.document))return!1;for(var d=a.document.querySelector(b),e=document.styleSheets,f={},g=0;g<e.length;g++)for(var h=e[g],i=h.href||"stylesheet_"+h.ownerNode.getAttribute("data-loggid"),j=h.cssRules||h.rules||[],k=0;k<j.length;k++){var o=j[k].selectorText;if(l(d,o)){f[o]=f[o]||[];var p={};p[i]=m(j[k].style),f[o].push(p)}}var q={message_type:"element_styles",content:JSON.stringify(n(f)),in_reply_to:C};return void 0!==c&&c!==!0?q:void H.post({url:r+"/messages",data:q})},I.getMatchedCSSRules=I.getElementStyles,I.getElementEvents=function(b,c){if(!("querySelector"in a.document))return!1;var d,e={};d="window"===b?a:a.document.querySelector(b);var f=y.indexOf(d);f>-1&&(e=x[f]);var g={message_type:"element_events",content:JSON.stringify(n(e)),in_reply_to:C};return void 0!==c&&c!==!0?g:void H.post({url:r+"/messages",data:g})},I.inspect=function(a){var b=I.boxModel(a,!1),c=I.getComputedStyle(a,!1),d=I.getElementProperties(a,!1),e=I.getElementStyles(a,!1),f=I.getElementEvents(a,!1),g={message_type:"element_inspect",content:JSON.stringify({boxModel:b,computedStyle:c,properties:d,styles:e,events:f}),in_reply_to:C};H.post({url:r+"/messages",data:g})},I.getNavigator=function(){var a={message_type:"navigator",content:JSON.stringify(e())};H.post({url:r+"/messages",data:a})},I.trackLocation=function(){var b={message_type:"location",content:a.location.toString()};H.post({url:r+"/messages",data:b})},I.getCookies=function(a){var b=p(document.cookie.split(";"),function(a){var b=q(a).split("="),c={};return c[b[0]]=b[1],c});return void 0!==a&&a!==!0?b:void H.post({url:r+"/messages",data:{message_type:"cookies",content:JSON.stringify(n(b)),in_reply_to:C}})},I.getLocalStorage=function(b){for(var c={},d=Object.keys(a.localStorage),e=0;e<d.length;e++){var f=d[e],g=a.localStorage[f];c[f]=g}return void 0!==b&&b!==!0?c:void H.post({url:r+"/messages",data:{message_type:"localstorage",content:JSON.stringify(n(c)),in_reply_to:C}})},I.getSessionStorage=function(b){for(var c={},d=Object.keys(a.sessionStorage),e=0;e<d.length;e++){var f=d[e],g=a.sessionStorage[f];c[f]=g}return void 0!==b&&b!==!0?c:void H.post({url:r+"/messages",data:{message_type:"sessionstorage",content:JSON.stringify(n(c)),in_reply_to:C}})},I.getScripts=function(a){var b=p(document.scripts,function(a){var b;return b=a.getAttribute("src")?a.getAttribute("src"):"script_"+a.getAttribute("data-loggid")});return void 0!==a&&a!==!0?b:void H.post({url:r+"/messages",data:{message_type:"scripts",content:JSON.stringify(n(b)),in_reply_to:C}})},I.getStyleSheets=function(a){for(var b={},c=0;c<document.styleSheets.length;c++){var d=document.styleSheets[c],e=d.href||"stylesheet_"+d.ownerNode.getAttribute("data-loggid"),f=d.cssRules||d.rules||[];b[e]="";for(var g=0;g<f.length;g++){var h=f[g].cssText;b[e]+="\n"+h}}return void 0!==a&&a!==!0?b:void H.post({url:r+"/messages",data:{message_type:"stylesheets",content:JSON.stringify(n(b)),in_reply_to:C}})},a.Logg=a.logg=a.Scope=I}(window);