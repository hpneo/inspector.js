/* Inspector.js v0.1.0 */
!function(a){function b(){return{navigator:{appCodeName:navigator.appCodeName,appName:navigator.appName,onLine:navigator.onLine,platform:navigator.platform,product:navigator.product,productSub:navigator.productSub,vendor:navigator.vendor,vendorSub:navigator.vendorSub}}}function c(){for(var a=navigator.userAgent.toLowerCase().replace(/ /g,"").split(""),b=0,c=0;c<a.length;c++)b+=a[c].charCodeAt();return b}function d(b,c){var d;if("FormData"in a){d=new FormData;for(var e in c)d.append(e,c[e])}else{b.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d=[];for(var f in c)d.push(f+"="+encodeURIComponent(c[f]));d=d.join("&")}return d}function e(b,c){a.setTimeout(function(){z.get({url:k+"/instructions?last_id="+v+"&device_id="+w,data:b,onload:function(d){if(d=JSON.parse(d),d&&d.id){v=d.id;var f=new Function(d.code);f.call(a)}e(b,c)}})},c)}function f(a){var b=Date.now(),c=Math.random()*b,d=Math.ceil(b+c);a.setAttribute("data-loggid",d);for(var e=0;e<a.children.length;e++)f(a.children[e])}function g(a){var b=a.tagName.toLowerCase();return""!==a.id&&(b+="#"+a.id),""!==a.className&&(b+="#"+a.className.replace(/ /g,".")),b}function h(a){var b,c;b=[];for(var c in a)b.push(c);return b}function i(a,b){var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector||a.matchesSelector||a.matches;return void 0===c?!1:c.call(a,b)}function j(a){var b;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a)b=a;else if(a instanceof String||a instanceof Number||a instanceof Boolean)b=a.constructor(a);else if("undefined"==typeof a)b="undefined";else if(null===a)b=null;else if(a instanceof Function)b=a.toString();else if(a instanceof Date)b=a;else if(a instanceof Document)b="#document";else if(a instanceof Window)b="window";else if(a instanceof Comment)b="<!--"+a.nodeValue+"-->";else if(a instanceof Text)b=a.nodeValue;else if(a instanceof Attr)b={},b[a.name]=a.nodeValue;else if(a instanceof HTMLElement){b={};for(var c=h(a),d=0;d<c.length;d++){var e=c[d];try{i=a[e]}catch(f){i=void 0}i instanceof HTMLElement&&(i=g(i)),b[e]=j(i)}}else if(a instanceof Array||a instanceof NodeList||a instanceof HTMLCollection){b=[];for(var d=0;d<a.length;d++){var i=a[d];i instanceof HTMLElement&&(i=g(i)),b.push(j(i))}}else if(a instanceof Object){b={};for(var c=h(a),d=0;d<c.length;d++){var e=c[d];b[e]=j(a[e])}}return b}var k="http://loggio.herokuapp.com/endpoint",l=XMLHttpRequest,m=function(){this.xhr=new l;var a=this;a.readyState=a.xhr.readyState,a.response=a.xhr.response,a.responseText=a.xhr.responseText,a.responseXML=a.xhr.responseXML,a.responseType=a.xhr.responseType,a.status=a.xhr.status,a.statusText=a.xhr.statusText,a.xhr.addEventListener("readystatechange",function(){a.readyState=a.xhr.readyState,a.response=a.xhr.response,a.responseText=a.xhr.responseText,a.responseXML=a.xhr.responseXML,a.responseType=a.xhr.responseType,a.status=a.xhr.status,a.statusText=a.xhr.statusText})};m.prototype=Object.create(l.prototype),m.prototype.addEventListener=function(){return this.xhr.addEventListener.apply(this.xhr,arguments)},m.prototype.abort=function(){return this.xhr.abort.apply(this.xhr,arguments)},m.prototype.getAllResponseHeaders=function(){return this.xhr.getAllResponseHeaders.apply(this.xhr,arguments)},m.prototype.getResponseHeader=function(){return this.xhr.getResponseHeader.apply(this.xhr,arguments)},m.prototype.open=function(){return this.xhr.open.apply(this.xhr,arguments)},m.prototype.overrideMimeType=function(){return this.xhr.overrideMimeType.apply(this.xhr,arguments)},m.prototype.send=function(){return this.xhr.send.apply(this.xhr,arguments)},m.prototype.setRequestHeader=function(){return this.xhr.setRequestHeader.apply(this.xhr,arguments)},a.XMLHttpRequest=m;var n;n="EventTarget"in a?EventTarget.prototype:Node.prototype;var o=n.addEventListener,p=n.removeEventListener,q={},r=[];n.addEventListener=function(){-1===r.indexOf(this)&&r.push(this);var a=r.indexOf(this);q[a]=q[a]||{},q[a][arguments[0]]=q[a][arguments[0]]||[],q[a][arguments[0]].push({handler:arguments[1],useCapture:void 0===arguments[2]?!1:arguments[2]}),o.apply(this,arguments)},n.removeEventListener=function(){var a=r.indexOf(this);if(a>-1){q[a]=q[a]||{},q[a][arguments[0]]=q[a][arguments[0]]||[];for(var b=0;b<q[a][arguments[0]].length;b++){var c=q[a][arguments[0]][b];if(c.handler===arguments[1]){q[a][arguments[0]].splice(b,1);break}}}p.apply(this,arguments)};var s,t=!1,u=1500,v=0,w=0,x=0,y=!1,z={request:function(b,c){c=c||{},c.data=c.data||{},c.data.device_id=w;var e=new l;e.open(b,c.url,!0);var f=d(e,c.data);e.onload=function(){4===this.readyState&&c.onload&&c.onload.call(a,e.responseText),e=null},e.send(f)},get:function(a){z.request("GET",a)},post:function(a){z.request("POST",a)}},A={settings:{},register:function(a){this.settings.navigator=navigator.userAgent;var b=a.identifier;a.name?this.settings.name=a.name:(this.settings.name=b.replace(/-/g," "),this.settings.name=this.settings.name[0].toUpperCase()+this.settings.name.substring(1)),-1===this.settings.name.indexOf("("+navigator.platform+")")&&(this.settings.name=this.settings.name+" ("+navigator.platform+")"),this.settings.identifier=-1===b.indexOf("-"+c())?b+"-"+c():b,this.settings.group=a.group?a.group:b.replace("-"+c(),""),this.settings.client_key=a.client_key;var d={identifier:this.settings.identifier,navigator:this.settings.navigator,name:this.settings.name,client_key:this.settings.client_key,group:this.settings.group};z.post({url:k+"/register",data:d,onload:function(a){y=!0;var a=JSON.parse(a);a&&"error"in a?alert(a.error):(a.id&&(v=a.id),a&&(w=a.device_id),a.device_group_id&&(x=a.device_group_id),w&&(A.init(),A.trackLocation()))}}),f(document.documentElement),A.initHighlight()},init:function(){if(A.log&&A.log("DOMScope is working now"),y){t=void 0!==this.settings.polling?this.settings.polling:t,u=void 0!=this.settings.pollingInterval?this.settings.pollingInterval:u;var a={last_id:v,device_id:w};e(a,u)}},destroy:function(){s&&a.clearInterval(s)}};a.onerror=function(a,b,c,d){var e={message_type:"native_error",content:{message:a,script:b,line:c}};return void 0!==d&&(e.content.column=d),e.content=JSON.stringify(e.content),z.post({url:k+"/messages",data:e}),!0};var B=["log","info","warn","error"];for(var C in B){var D=B[C];!function(a){A[a]=function(){var b=[].slice.call(arguments,0),c={message_type:a,content:JSON.stringify(j(b))};z.post({url:k+"/messages",data:c})}}(D)}A.initHighlight=function(){var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div");b.id="margin_container",c.id="border_container",d.id="padding_container",e.id="content_container",b.style.position="absolute",c.style.position="absolute",d.style.position="absolute",e.style.position="absolute",b.style.backgroundColor="rgb(211, 84, 0)",c.style.backgroundColor="rgb(243, 156, 18)",d.style.backgroundColor="rgb(39, 174, 96)",e.style.backgroundColor="rgb(41, 128, 185)",b.style.opacity="0.35",d.appendChild(e),c.appendChild(d),b.appendChild(c),b.style.width="0px",b.style.height="0px",b.style.zIndex=616,b.style.overflow="hidden",a.document.body.appendChild(b)},A.resetHighlight=function(){var b=a.document.getElementById("margin_container");b.style.width="0px",b.style.height="0px"},A.highlightElement=function(b){if("string"==typeof b&&"querySelector"in a.document&&(b=a.document.querySelector(b)),!b)return!1;if(!("getBoundingClientRect"in b||"getComputedStyle"in a))return!1;var c=a.getComputedStyle(b),d=b.getBoundingClientRect(),e={contentWidth:parseInt(b.clientWidth)-parseInt(c.paddingLeft)-parseInt(c.paddingRight)-parseInt(c.borderLeftWidth)-parseInt(c.borderRightWidth),contentHeight:parseInt(b.clientHeight)-parseInt(c.paddingTop)-parseInt(c.paddingBottom)-parseInt(c.borderTopWidth)-parseInt(c.borderBottomWidth),borderTopWidth:parseInt(c.borderTopWidth),borderBottomWidth:parseInt(c.borderBottomWidth),borderLeftWidth:parseInt(c.borderLeftWidth),borderRightWidth:parseInt(c.borderRightWidth),marginTop:parseInt(c.marginTop),marginBottom:parseInt(c.marginBottom),marginLeft:parseInt(c.marginLeft),marginRight:parseInt(c.marginRight),paddingTop:parseInt(c.paddingTop),paddingBottom:parseInt(c.paddingBottom),paddingLeft:parseInt(c.paddingLeft),paddingRight:parseInt(c.paddingRight),clientWidth:b.clientWidth,clientHeight:b.clientHeight},f=document.getElementById("margin_container"),g=document.getElementById("border_container"),h=document.getElementById("padding_container"),i=document.getElementById("content_container");f.style.top=d.top-e.marginTop+"px",f.style.left=d.left-e.marginLeft+"px",f.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+e.marginLeft+e.marginRight+"px",f.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+e.marginTop+e.marginBottom+"px",g.style.top=e.marginTop+"px",g.style.left=e.marginLeft+"px",g.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+e.borderLeftWidth+e.borderRightWidth+"px",g.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+e.borderTopWidth+e.borderBottomWidth+"px",h.style.top="0px",h.style.left="0px",h.style.width=e.contentWidth+e.paddingLeft+e.paddingRight+"px",h.style.height=e.contentHeight+e.paddingTop+e.paddingBottom+"px",i.style.top=e.paddingTop+"px",i.style.left=e.paddingLeft+"px",i.style.width=e.contentWidth+"px",i.style.height=e.contentHeight+"px"},A.getDOM=function(){var a=document.doctype,b="";if(a)var b="<!DOCTYPE "+a.name+(a.publicId?' PUBLIC "'+a.publicId+'"':"")+(!a.publicId&&a.systemId?" SYSTEM":"")+(a.systemId?' "'+a.systemId+'"':"")+">";var c={message_type:"dom",content:b+document.documentElement.outerHTML,in_reply_to:v};z.post({url:k+"/messages",data:c})},A.boxModel=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e=a.getComputedStyle(d),f={};f[b]={contentWidth:parseInt(d.clientWidth)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),contentHeight:parseInt(d.clientHeight)-parseInt(e.paddingTop)-parseInt(e.paddingBottom)-parseInt(e.borderTopWidth)-parseInt(e.borderBottomWidth),borderTopWidth:parseInt(e.borderTopWidth),borderBottomWidth:parseInt(e.borderBottomWidth),borderLeftWidth:parseInt(e.borderLeftWidth),borderRightWidth:parseInt(e.borderRightWidth),marginTop:parseInt(e.marginTop),marginBottom:parseInt(e.marginBottom),marginLeft:parseInt(e.marginLeft),marginRight:parseInt(e.marginRight),paddingTop:parseInt(e.paddingTop),paddingBottom:parseInt(e.paddingBottom),paddingLeft:parseInt(e.paddingLeft),paddingRight:parseInt(e.paddingRight),clientWidth:d.clientWidth,clientHeight:d.clientHeight,offsetWidth:d.offsetWidth,offsetHeight:d.offsetHeight,scrollWidth:d.scrollWidth,scrollHeight:d.scrollHeight};var g={message_type:"box_model",content:JSON.stringify(f),in_reply_to:v};return c?void z.post({url:k+"/messages",data:g}):g},A.getComputedStyle=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e={},f=a.getComputedStyle(d),g=Array.prototype.slice.call(f,0);e[b]={};for(var h=0;h<g.length;h++){var i=g[h];e[b][i]=encodeURIComponent(f[i])}d=f=g=null;var j={message_type:"computed_style",content:JSON.stringify(e),in_reply_to:v};return c?void z.post({url:k+"/messages",data:j}):j},A.getElementProperties=function(b,c){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;var d=a.document.querySelector(b),e={message_type:"element_properties",content:JSON.stringify(j(d)),in_reply_to:v};return c?void z.post({url:k+"/messages",data:e}):e},A.getElementStyles=function(b){if(!("querySelector"in a.document||"getComputedStyle"in a))return!1;for(var c=a.document.querySelector(b),d=document.styleSheets,e={},f=0;f<d.length;f++)for(var g=d[f].cssRules||d[f].rules||[],h=0;h<g.length;h++){var j=g[h].selectorText;i(c,j)&&(e[j]=e[j]||[],e[j].push(g[h].style))}return e},A.inspect=function(a){var b=A.boxModel(a,!1),c=A.getComputedStyle(a,!1),d=A.getElementProperties(a,!1),e=A.getElementStyles(a,!1),f={message_type:"element_inspect",content:JSON.stringify({boxModel:b,computedStyle:c,properties:d,styles:e}),in_reply_to:v};z.post({url:k+"/messages",data:f})},A.getNavigator=function(){var a={message_type:"navigator",content:JSON.stringify(b())};z.post({url:k+"/messages",data:a})},A.trackLocation=function(){var b={message_type:"location",content:a.location.toString()};z.post({url:k+"/messages",data:b})},a.Logg=a.logg=a.Scope=A}(window);